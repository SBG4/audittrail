---
phase: 04-file-batch-grouping
plan: 03
type: execute
wave: 2
depends_on: ["04-01"]
files_modified:
  - client/src/components/batches/BatchTemplates.tsx
  - client/src/data/batch-templates.ts
  - client/src/components/batches/BatchForm.tsx
autonomous: true

must_haves:
  truths:
    - "User can see a list of quick-add templates when creating a file batch"
    - "Selecting a template pre-fills the batch form with default values"
    - "User can modify template-filled values before saving"
    - "Templates cover common audit scenarios (USB file copy, email attachments)"
  artifacts:
    - path: "client/src/data/batch-templates.ts"
      provides: "Static array of batch template presets"
      exports: ["BATCH_TEMPLATES", "BatchTemplate"]
    - path: "client/src/components/batches/BatchTemplates.tsx"
      provides: "Template selector component"
      contains: "BatchTemplates"
  key_links:
    - from: "client/src/components/batches/BatchTemplates.tsx"
      to: "client/src/data/batch-templates.ts"
      via: "import BATCH_TEMPLATES"
      pattern: "BATCH_TEMPLATES"
    - from: "client/src/components/batches/BatchForm.tsx"
      to: "client/src/components/batches/BatchTemplates.tsx"
      via: "component composition"
      pattern: "BatchTemplates"
---

<objective>
Quick-add templates for common file grouping patterns that pre-fill the batch creation form.

Purpose: Speeds up batch creation for repetitive scenarios. Auditors frequently create batches with similar patterns (USB file copies, email attachments, network transfers). Templates eliminate redundant typing by pre-filling form fields with sensible defaults that the auditor can adjust before saving.

Output: Template data file, template selector component, and BatchForm integration.
</objective>

<execution_context>
@/Users/shiro/.claude/get-shit-done/workflows/execute-plan.md
@/Users/shiro/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-file-batch-grouping/04-RESEARCH.md
@.planning/phases/04-file-batch-grouping/04-01-SUMMARY.md
@client/src/types/file-batch.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Batch template data and template selector component</name>
  <files>
    client/src/data/batch-templates.ts
    client/src/components/batches/BatchTemplates.tsx
  </files>
  <action>
    Create `client/src/data/batch-templates.ts`:
    - Export `BatchTemplate` interface: `{ id: string; name: string; icon: string; description: string; defaults: { label: string; file_count?: number; description?: string; file_types?: string } }`
    - Export `BATCH_TEMPLATES: BatchTemplate[]` with these presets:
      1. **USB File Copy** - id: "usb-file-copy", icon: "usb", label: "USB File Copy", file_types: ".pdf, .docx, .xlsx, .pptx, .txt", description: "Files copied to/from USB storage device"
      2. **Email Attachments** - id: "email-attachments", icon: "mail", label: "Email Attachments", file_types: ".pdf, .docx, .xlsx, .zip, .msg", description: "Attachments extracted from email messages"
      3. **Network Transfer** - id: "network-transfer", icon: "network", label: "Network File Transfer", file_types: ".pdf, .docx, .xlsx, .csv", description: "Files transferred via network share or mapped drive"
      4. **Print Job** - id: "print-job", icon: "printer", label: "Print Job", file_types: ".pdf, .docx", description: "Documents sent to printer"
      5. **Cloud Upload** - id: "cloud-upload", icon: "cloud-upload", label: "Cloud Upload", file_types: ".pdf, .docx, .xlsx, .zip", description: "Files uploaded to cloud storage service"
      6. **Custom** - id: "custom", icon: "plus", label: "", file_types: "", description: "" (blank template for fully custom entry)

    Create `client/src/components/batches/BatchTemplates.tsx`:
    - Props: `onSelect: (template: BatchTemplate) => void`
    - Renders a horizontal row of template buttons (compact, not a dropdown)
    - Each button shows: icon (lucide-react) + template name
    - Icons mapped from template.icon string to lucide components (Usb, Mail, Network, Printer, CloudUpload, Plus)
    - Buttons use `variant="outline"` and `size="sm"` styling
    - Active/selected state not needed -- templates are one-shot actions
    - Clicking a template button calls onSelect with the template object
    - Layout: flex wrap with gap-2, so templates flow naturally on narrow screens
  </action>
  <verify>
    - TypeScript compiles: `cd client && npx tsc --noEmit --pretty 2>&1 | head -20`
    - BATCH_TEMPLATES array has 6 entries
    - BatchTemplates component renders template buttons with icons
  </verify>
  <done>Static batch templates data file with 6 presets (USB, email, network, print, cloud, custom). BatchTemplates selector component renders compact icon buttons that trigger onSelect callback with template defaults.</done>
</task>

<task type="auto">
  <name>Task 2: Integrate templates into BatchForm</name>
  <files>
    client/src/components/batches/BatchForm.tsx
  </files>
  <action>
    Update BatchForm (created in 04-02) to integrate template support:

    - Add `BatchTemplates` component at the top of the form (only in create mode, not edit mode)
    - When a template is selected via `onSelect`:
      - Pre-fill form fields with template.defaults values
      - Only overwrite fields that have template defaults (don't clear fields the template doesn't specify)
      - If the form already has user-entered data in a field, still overwrite (template selection is an intentional action)
      - After pre-fill, focus the first empty required field (likely file_count since templates don't set it)
    - Template row has a label "Quick add:" before the template buttons
    - Visual flow: "Quick add: [USB] [Email] [Network] [Print] [Cloud] [Custom]" then the form fields below
    - The Custom template clears all fields to blank (fresh start)

    The BatchForm should work identically whether a template was used or not -- templates just pre-fill, the save flow is unchanged.
  </action>
  <verify>
    - TypeScript compiles: `cd client && npx tsc --noEmit --pretty 2>&1 | head -20`
    - BatchForm shows template buttons in create mode
    - Template buttons do not appear in edit mode
    - Selecting a template populates form fields
  </verify>
  <done>BatchForm integrates BatchTemplates at the top in create mode. Template selection pre-fills label, file_types, and description. User can adjust any pre-filled value before saving. Edit mode skips template display.</done>
</task>

</tasks>

<verification>
- Templates data file exports 6 presets with correct structure
- Template selector renders clickable buttons with appropriate icons
- BatchForm shows templates only in create mode
- Selecting a template populates form fields with defaults
- User can modify all pre-filled values before saving
- Custom template provides blank slate
</verification>

<success_criteria>
- User sees quick-add template buttons when creating a new file batch
- Clicking "USB File Copy" pre-fills label, file types, and description
- Clicking "Email Attachments" pre-fills with email-specific defaults
- User can adjust any pre-filled value before saving
- Templates do not appear when editing an existing batch
- Custom template provides empty form for fully manual entry
- All templates cover the common audit scenarios specified in requirements (FILE-03)
</success_criteria>

<output>
After completion, create `.planning/phases/04-file-batch-grouping/04-03-SUMMARY.md`
</output>
