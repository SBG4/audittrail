---
phase: 03-timeline-events
plan: 04
type: execute
wave: 3
depends_on: ["03-02"]
files_modified:
  - client/src/components/timeline/DateTimeInput.tsx
  - client/src/components/timeline/TimelineView.tsx
  - client/src/components/timeline/TimelineRow.tsx
autonomous: true

must_haves:
  truths:
    - "Date picker allows selecting a date with minimal clicks"
    - "Time input allows fast time entry"
    - "Tab moves between fields within a timeline row"
    - "Enter on the last field of the last row creates a new event"
    - "Keyboard-only workflow is possible for entering multiple events"
  artifacts:
    - path: "client/src/components/timeline/DateTimeInput.tsx"
      provides: "Optimized date and time input component"
    - path: "client/src/components/timeline/TimelineView.tsx"
      provides: "Updated view with keyboard navigation support"
    - path: "client/src/components/timeline/TimelineRow.tsx"
      provides: "Updated row with keyboard event handlers"
  key_links:
    - from: "client/src/components/timeline/TimelineRow.tsx"
      to: "client/src/components/timeline/TimelineView.tsx"
      via: "onCreateNew callback for Enter on last row"
---

<objective>
Implement fast date/time entry and keyboard navigation for rapid event data entry. Tab navigates between fields, Enter creates new events from the last row.

Purpose: Fast data entry workflow (EVNT-03, EVNT-08)
Output: DateTimeInput component, keyboard navigation in TimelineView/TimelineRow
</objective>

<execution_context>
@/Users/shiro/.claude/get-shit-done/workflows/execute-plan.md
@/Users/shiro/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@client/src/components/timeline/TimelineView.tsx
@client/src/components/timeline/TimelineRow.tsx
@client/src/components/timeline/InlineField.tsx
@.planning/phases/03-timeline-events/03-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: DateTimeInput component for fast date/time entry</name>
  <files>
    client/src/components/timeline/DateTimeInput.tsx
  </files>
  <action>
    Create client/src/components/timeline/DateTimeInput.tsx:
    A specialized component for date and time entry optimized for speed.

    Props:
    - date: string (ISO date YYYY-MM-DD)
    - time: string | null (HH:MM)
    - onDateChange: (date: string) => void
    - onTimeChange: (time: string | null) => void
    - onKeyDown?: (e: React.KeyboardEvent) => void (for parent keyboard navigation)

    Layout: Two adjacent inputs in a flex row.
    - Date: Native <input type="date"> with value pre-set. Clicking opens browser date picker. Default to today if empty.
    - Time: Native <input type="time"> with value pre-set. Clicking opens browser time picker. Allow empty.

    Both inputs:
    - styled consistently with existing Input component (border, rounded, text-sm)
    - compact sizing (h-8, px-2)
    - Forward onKeyDown events to parent for Tab/Enter handling
    - onBlur triggers save callback

    The native date/time inputs are fast because:
    - Date: One click opens calendar, one click selects date = 2 clicks minimum
    - Time: Click and type HH:MM or use up/down arrows = very fast
    - No additional library required
  </action>
  <verify>No TypeScript errors. DateTimeInput renders date and time inputs side by side.</verify>
  <done>Fast date/time input component exists with native browser pickers</done>
</task>

<task type="auto">
  <name>Task 2: Keyboard navigation in TimelineView and TimelineRow</name>
  <files>
    client/src/components/timeline/TimelineView.tsx
    client/src/components/timeline/TimelineRow.tsx
  </files>
  <action>
    Update TimelineRow to support keyboard navigation:
    - Add data-row-index attribute to the table row for identification
    - Each editable cell gets a data-col-index attribute
    - When InlineField exits edit mode via Tab, the natural DOM tab order moves to the next focusable element in the row (next InlineField's display span or the delete button)
    - InlineField spans should have tabIndex={0} so they participate in tab order
    - When an InlineField receives focus (via tab), it can optionally enter edit mode on focus (controlled by a prop or auto-detect)

    Add onCreateNew callback prop to TimelineRow:
    - Only provided to the LAST row in the timeline
    - When user presses Enter on the last field of the last row, call onCreateNew()
    - This creates a new event with today's date and "note" type

    Update TimelineView:
    - Pass onCreateNew to the last TimelineRow only
    - onCreateNew calls createEvent.mutate with default values (today's date, "note" type)
    - After new event is created, the new row should appear at the bottom (or in chronological position)
    - Add a keyboard shortcut hint below the table: "Tab to navigate between fields. Enter on the last field to add a new event."

    Integrate DateTimeInput into TimelineRow:
    - Replace the separate date and time InlineFields with DateTimeInput component
    - DateTimeInput handles both date and time in one compact widget
    - onDateChange and onTimeChange each call the onFieldUpdate callback

    Table should use natural DOM order for Tab navigation. No manual focus management needed -- the browser's native Tab behavior handles sequential focus between tabIndex={0} elements.
  </action>
  <verify>No TypeScript errors. Tab moves between fields in a row. Enter on last row creates a new event.</verify>
  <done>Keyboard navigation works: Tab between fields, Enter creates new events from last row</done>
</task>

</tasks>

<verification>
- Tab key moves focus through all editable fields in a timeline row
- Shift+Tab moves focus backward
- Enter on last field of last row creates a new event
- Date picker opens with minimal clicks (native browser picker)
- Time can be entered by typing HH:MM
</verification>

<success_criteria>
- DateTimeInput provides fast date/time entry with native pickers
- Tab navigation works across all fields in timeline rows
- Enter on last row creates a new event
- Keyboard hint text visible below the table
</success_criteria>

<output>
After completion, create `.planning/phases/03-timeline-events/03-04-SUMMARY.md`
</output>
